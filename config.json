{
	"name": "API Sync",
	"namespace": "Vanderbilt\\APISyncExternalModule",
	"framework-version": 2,
	"description": "<b>Overwrites the data in this project daily</b> from a remote REDCap server via the API.  The Data Dictionaries for both projects are expected to be either identical or compatible.  This module could easily be expanded to support other multi-server synchronization tasks as well.  Very large projects may not work properly.  In one case an import took 15 minutes for a project with about 10,000 records and 1,500 fields.",
	"authors": [
		{
			"name": "Mark McEver",
			"email": "datacore@vumc.org",
			"institution": "Vanderbilt University Medical Center"
		}
	],
	"permissions": [
		"redcap_save_record",
		"redcap_every_page_before_render"
	],
	"project-settings": [
		{
			"key": "disable-error-emails",
			"name": "<div style='max-width: 350px; display: inline-block;'>Disable error notification emails to superusers on the project (or the general system admin email if there are none on the project).</div>",
			"type": "checkbox"
		},
		{
			"key": "push-batch-size",
			"name": "Real-time push batch size (optional)",
			"type": "text"
		},
		{
			"key": "push-descriptive",
			"name": "<b>Real-Time Push:</b> The real-time push feature overwrites remote data with local data within a minute or two of a record being saved (or deleted).  A one-time push of all records can be performed via the <b>API Sync</b> page/link in the left menu.",
			"type": "descriptive"
		},
		{
			"key": "push-servers",
			"name": "Real-Time Push Destinations",
			"type": "sub_settings",
			"repeatable" : true,
			"sub_settings" : [
				{
					"key": "push-redcap-url",
					"name": "Remote REDCap URL",
					"type": "text"
				},
				{
					"key": "push-projects",
					"name": "Project",
					"type": "sub_settings",
					"repeatable" : true,
					"sub_settings" : [
						{
							"key": "push-project-name",
							"name": "Project Name (required for logging)",
							"type": "text"
						},
						{
							"key": "push-api-key",
							"name": "API Key",
							"type": "text"
						}
					]
				}
			]
		},
		{
			"key": "servers",
			"name": "Daily Import Sources",
			"type": "sub_settings",
			"repeatable" : true,
			"sub_settings" : [
				{
					"key": "redcap-url",
					"name": "Remote REDCap URL",
					"type": "text"
				},
				{
					"key": "daily-record-import-hour",
					"name": "Daily Record Import Hour (0-23)",
					"type": "text"
				},
				{
					"key": "daily-record-import-minute",
					"name": "Daily Record Import Minute (0-59)",
					"type": "text"
				},
				{
					"key": "projects",
					"name": "Project",
					"type": "sub_settings",
					"repeatable" : true,
					"sub_settings" : [
						{
							"key": "api-key",
							"name": "API Key",
							"type": "text"
						},
						{
							"key": "record-id-prefix",
							"name": "<div style='max-width: 350px; display: inline-block;'><b>Record ID Prefix</b> - If data is being imported from multiple projects or entered manually it is <b>highly recommended</b> to specify a record id prefix.  This prefix will be prepended to all imported records ids to ensure that they're unique.</div>",
							"type": "text"
						},
						{
							"key": "leave-unlocked",
							"name": "Skip form/instance locking after import",
							"type": "checkbox"
						}
					]
				}
			]
		}
	],
	"links": {
		"project": [
			{
				"name": "API Sync",
				"icon": "databases_arrow",
				"url": "api-sync.php",
				"show-header-and-footer": true
			}
		]
	},
	"crons": [
		{
			"cron_name": "cron",
			"cron_description": "API Sync External Module",
			"method": "cron",
			"cron_frequency": "1",
			"cron_max_run_time": "7200"
		}
	],
	"compatibility": {
		"redcap-version-min": "9.0.0",
		"redcap-version-min-reason": "EM Framework commit b184817 is required"
	}
}
